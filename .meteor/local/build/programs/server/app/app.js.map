{"version":3,"sources":["meteor://ðŸ’»app/imports/api/documents/server/publications.js","meteor://ðŸ’»app/imports/api/documents/documents.js","meteor://ðŸ’»app/imports/api/documents/methods.js","meteor://ðŸ’»app/imports/startup/server/accounts/email-templates.js","meteor://ðŸ’»app/imports/startup/server/api.js","meteor://ðŸ’»app/imports/startup/server/browser-policy.js","meteor://ðŸ’»app/imports/startup/server/fixtures.js","meteor://ðŸ’»app/imports/startup/server/index.js","meteor://ðŸ’»app/imports/modules/rate-limit.js","meteor://ðŸ’»app/server/main.js"],"names":["Meteor","module","watch","require","v","check","Documents","publish","find","_id","String","Mongo","SimpleSchema","Factory","Collection","exportDefault","allow","insert","update","remove","deny","schema","title","type","label","body","attachSchema","define","export","upsertDocument","removeDocument","ValidatedMethod","rateLimit","name","validate","optional","validator","run","document","upsert","$set","methods","limit","timeRange","Accounts","email","from","emailTemplates","siteName","resetPassword","subject","text","user","url","userEmail","emails","address","urlWithoutHash","replace","BrowserPolicy","content","allowFontOrigin","Roles","isProduction","users","password","profile","first","last","roles","forEach","userExists","findOne","userId","createUser","addUsersToRoles","DDPRateLimiter","_","fetchMethodNames","pluck","assignLimits","methodNames","isServer","addRule","contains","connectionId","options"],"mappings":"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","file":"/app.js","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { check } from 'meteor/check';\nimport Documents from '../documents';\n\nMeteor.publish('documents.list', () => Documents.find());\n\nMeteor.publish('documents.view', (_id) => {\n  check(_id, String);\n  return Documents.find(_id);\n});\n","import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\nimport { Factory } from 'meteor/dburles:factory';\n\nconst Documents = new Mongo.Collection('Documents');\nexport default Documents;\n\nDocuments.allow({\n  insert: () => false,\n  update: () => false,\n  remove: () => false,\n});\n\nDocuments.deny({\n  insert: () => true,\n  update: () => true,\n  remove: () => true,\n});\n\nDocuments.schema = new SimpleSchema({\n  title: {\n    type: String,\n    label: 'The title of the document.',\n  },\n  body: {\n    type: String,\n    label: 'The body of the document.',\n  },\n});\n\nDocuments.attachSchema(Documents.schema);\n\nFactory.define('document', Documents, {\n  title: () => 'Factory Title',\n  body: () => 'Factory Body',\n});\n","import SimpleSchema from 'simpl-schema';\nimport { ValidatedMethod } from 'meteor/mdg:validated-method';\nimport Documents from './documents';\nimport rateLimit from '../../modules/rate-limit.js';\n\nexport const upsertDocument = new ValidatedMethod({\n  name: 'documents.upsert',\n  validate: new SimpleSchema({\n    _id: { type: String, optional: true },\n    title: { type: String, optional: true },\n    body: { type: String, optional: true },\n  }).validator(),\n  run(document) {\n    return Documents.upsert({ _id: document._id }, { $set: document });\n  },\n});\n\nexport const removeDocument = new ValidatedMethod({\n  name: 'documents.remove',\n  validate: new SimpleSchema({\n    _id: { type: String },\n  }).validator(),\n  run({ _id }) {\n    Documents.remove(_id);\n  },\n});\n\nrateLimit({\n  methods: [\n    upsertDocument,\n    removeDocument,\n  ],\n  limit: 5,\n  timeRange: 1000,\n});\n","import { Accounts } from 'meteor/accounts-base';\n\nconst name = 'Application Name';\nconst email = '<support@application.com>';\nconst from = `${name} ${email}`;\nconst emailTemplates = Accounts.emailTemplates;\n\nemailTemplates.siteName = name;\nemailTemplates.from = from;\n\nemailTemplates.resetPassword = {\n  subject() {\n    return `[${name}] Reset Your Password`;\n  },\n  text(user, url) {\n    const userEmail = user.emails[0].address;\n    const urlWithoutHash = url.replace('#/', '');\n\n    return `A password reset has been requested for the account related to this\n    address (${userEmail}). To reset the password, visit the following link:\n    \\n\\n${urlWithoutHash}\\n\\n If you did not request this reset, please ignore\n    this email. If you feel something is wrong, please contact our support team:\n    ${email}.`;\n  },\n};\n","import '../../api/documents/methods.js';\nimport '../../api/documents/server/publications.js';\n","import { BrowserPolicy } from 'meteor/browser-policy-common';\n// e.g., BrowserPolicy.content.allowOriginForAll( 's3.amazonaws.com' );\nBrowserPolicy.content.allowFontOrigin(\"data:\");\n","import { Meteor } from 'meteor/meteor';\nimport { Roles } from 'meteor/alanning:roles';\nimport { Accounts } from 'meteor/accounts-base';\n\nif (!Meteor.isProduction) {\n  const users = [{\n    email: 'admin@admin.com',\n    password: 'password',\n    profile: {\n      name: { first: 'Carl', last: 'Winslow' },\n    },\n    roles: ['admin'],\n  }];\n\n  users.forEach(({ email, password, profile, roles }) => {\n    const userExists = Meteor.users.findOne({ 'emails.address': email });\n\n    if (!userExists) {\n      const userId = Accounts.createUser({ email, password, profile });\n      Roles.addUsersToRoles(userId, roles);\n    }\n  });\n}\n","import './accounts/email-templates';\nimport './browser-policy';\nimport './fixtures';\nimport './api';\n","import { Meteor } from 'meteor/meteor';\nimport { DDPRateLimiter } from 'meteor/ddp-rate-limiter';\nimport { _ } from 'meteor/underscore';\n\nconst fetchMethodNames = methods => _.pluck(methods, 'name');\n\nconst assignLimits = ({ methods, limit, timeRange }) => {\n  const methodNames = fetchMethodNames(methods);\n\n  if (Meteor.isServer) {\n    DDPRateLimiter.addRule({\n      name(name) { return _.contains(methodNames, name); },\n      connectionId() { return true; },\n    }, limit, timeRange);\n  }\n};\n\nexport default function rateLimit(options) { return assignLimits(options); }\n","import '/imports/startup/server';\n"]}