{"version":3,"sources":["meteor://ðŸ’»app/imports/api/documents/server/publications.js","meteor://ðŸ’»app/imports/api/documents/documents.js","meteor://ðŸ’»app/imports/api/documents/methods.js","meteor://ðŸ’»app/imports/startup/server/accounts/email-templates.js","meteor://ðŸ’»app/imports/startup/server/api.js","meteor://ðŸ’»app/imports/startup/server/browser-policy.js","meteor://ðŸ’»app/imports/startup/server/fixtures.js","meteor://ðŸ’»app/imports/startup/server/index.js","meteor://ðŸ’»app/imports/modules/rate-limit.js","meteor://ðŸ’»app/server/main.js"],"names":["Meteor","module","link","v","check","Documents","default","publish","find","_id","String","Mongo","SimpleSchema","Factory","Collection","exportDefault","allow","insert","update","remove","deny","schema","title","type","label","body","attachSchema","define","export","upsertDocument","removeDocument","ValidatedMethod","rateLimit","name","validate","optional","validator","run","document","upsert","$set","methods","limit","timeRange","Accounts","email","from","emailTemplates","siteName","resetPassword","subject","text","user","url","userEmail","emails","address","urlWithoutHash","replace","BrowserPolicy","content","allowFontOrigin","Roles","isProduction","users","password","profile","first","last","roles","forEach","userExists","findOne","userId","createUser","addUsersToRoles","DDPRateLimiter","_","fetchMethodNames","pluck","assignLimits","methodNames","isServer","addRule","contains","connectionId","options"],"mappings":"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","file":"/app.js","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { check } from 'meteor/check';\nimport Documents from '../documents';\n\nMeteor.publish('documents.list', () => Documents.find());\n\nMeteor.publish('documents.view', (_id) => {\n  check(_id, String);\n  return Documents.find(_id);\n});\n","import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\nimport { Factory } from 'meteor/dburles:factory';\n\nconst Documents = new Mongo.Collection('Documents');\nexport default Documents;\n\nDocuments.allow({\n  insert: () => false,\n  update: () => false,\n  remove: () => false,\n});\n\nDocuments.deny({\n  insert: () => true,\n  update: () => true,\n  remove: () => true,\n});\n\nDocuments.schema = new SimpleSchema({\n  title: {\n    type: String,\n    label: 'The title of the document.',\n  },\n  body: {\n    type: String,\n    label: 'The body of the document.',\n  },\n});\n\nDocuments.attachSchema(Documents.schema);\n\nFactory.define('document', Documents, {\n  title: () => 'Factory Title',\n  body: () => 'Factory Body',\n});\n","import SimpleSchema from 'simpl-schema';\nimport { ValidatedMethod } from 'meteor/mdg:validated-method';\nimport Documents from './documents';\nimport rateLimit from '../../modules/rate-limit.js';\n\nexport const upsertDocument = new ValidatedMethod({\n  name: 'documents.upsert',\n  validate: new SimpleSchema({\n    _id: { type: String, optional: true },\n    title: { type: String, optional: true },\n    body: { type: String, optional: true },\n  }).validator(),\n  run(document) {\n    return Documents.upsert({ _id: document._id }, { $set: document });\n  },\n});\n\nexport const removeDocument = new ValidatedMethod({\n  name: 'documents.remove',\n  validate: new SimpleSchema({\n    _id: { type: String },\n  }).validator(),\n  run({ _id }) {\n    Documents.remove(_id);\n  },\n});\n\nrateLimit({\n  methods: [\n    upsertDocument,\n    removeDocument,\n  ],\n  limit: 5,\n  timeRange: 1000,\n});\n","import { Accounts } from 'meteor/accounts-base';\n\nconst name = 'Application Name';\nconst email = '<support@application.com>';\nconst from = `${name} ${email}`;\nconst emailTemplates = Accounts.emailTemplates;\n\nemailTemplates.siteName = name;\nemailTemplates.from = from;\n\nemailTemplates.resetPassword = {\n  subject() {\n    return `[${name}] Reset Your Password`;\n  },\n  text(user, url) {\n    const userEmail = user.emails[0].address;\n    const urlWithoutHash = url.replace('#/', '');\n\n    return `A password reset has been requested for the account related to this\n    address (${userEmail}). To reset the password, visit the following link:\n    \\n\\n${urlWithoutHash}\\n\\n If you did not request this reset, please ignore\n    this email. If you feel something is wrong, please contact our support team:\n    ${email}.`;\n  },\n};\n","import '../../api/documents/methods.js';\nimport '../../api/documents/server/publications.js';\n","import { BrowserPolicy } from 'meteor/browser-policy-common';\n// e.g., BrowserPolicy.content.allowOriginForAll( 's3.amazonaws.com' );\nBrowserPolicy.content.allowFontOrigin(\"data:\");\n","import { Meteor } from 'meteor/meteor';\nimport { Roles } from 'meteor/alanning:roles';\nimport { Accounts } from 'meteor/accounts-base';\n\nif (!Meteor.isProduction) {\n  const users = [{\n    email: 'admin@admin.com',\n    password: 'password',\n    profile: {\n      name: { first: 'Carl', last: 'Winslow' },\n    },\n    roles: ['admin'],\n  }];\n\n  users.forEach(({ email, password, profile, roles }) => {\n    const userExists = Meteor.users.findOne({ 'emails.address': email });\n\n    if (!userExists) {\n      const userId = Accounts.createUser({ email, password, profile });\n      Roles.addUsersToRoles(userId, roles);\n    }\n  });\n}\n","import './accounts/email-templates';\nimport './browser-policy';\nimport './fixtures';\nimport './api';\n","import { Meteor } from 'meteor/meteor';\nimport { DDPRateLimiter } from 'meteor/ddp-rate-limiter';\nimport { _ } from 'meteor/underscore';\n\nconst fetchMethodNames = methods => _.pluck(methods, 'name');\n\nconst assignLimits = ({ methods, limit, timeRange }) => {\n  const methodNames = fetchMethodNames(methods);\n\n  if (Meteor.isServer) {\n    DDPRateLimiter.addRule({\n      name(name) { return _.contains(methodNames, name); },\n      connectionId() { return true; },\n    }, limit, timeRange);\n  }\n};\n\nexport default function rateLimit(options) { return assignLimits(options); }\n","import '/imports/startup/server';\n"]}