[{"type":"js","data":"//////////////////////////////////////////////////////////////////////////\n//                                                                      //\n// This is a generated file. You can view the original                  //\n// source in your browser if your browser supports source maps.         //\n// Source maps are supported by all recent versions of Chrome, Safari,  //\n// and Firefox, and by Internet Explorer 11.                            //\n//                                                                      //\n//////////////////////////////////////////////////////////////////////////\n\n\n(function () {\n\n/* Imports */\nvar Meteor = Package.meteor.Meteor;\nvar global = Package.meteor.global;\nvar meteorEnv = Package.meteor.meteorEnv;\nvar Mongo = Package.mongo.Mongo;\nvar _ = Package.underscore._;\nvar meteorInstall = Package.modules.meteorInstall;\nvar meteorBabelHelpers = Package['babel-runtime'].meteorBabelHelpers;\nvar Promise = Package.promise.Promise;\nvar Symbol = Package['ecmascript-runtime-client'].Symbol;\nvar Map = Package['ecmascript-runtime-client'].Map;\nvar Set = Package['ecmascript-runtime-client'].Set;\n\n/* Package-scope variables */\nvar resetDatabase;\n\nvar require = meteorInstall({\"node_modules\":{\"meteor\":{\"xolvio:cleaner\":{\"cleaner.js\":function(){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                   //\n// packages/xolvio_cleaner/cleaner.js                                                                                //\n//                                                                                                                   //\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                     //\nif (Meteor.isServer) {\n  var _resetDatabase = function (options) {\n    if (process.env.NODE_ENV !== 'development') {\n      throw new Error('resetDatabase is not allowed outside of a development mode. ' + 'Aborting.');\n    }\n\n    options = options || {};\n    var excludedCollections = ['system.indexes'];\n\n    if (options.excludedCollections) {\n      excludedCollections = excludedCollections.concat(options.excludedCollections);\n    }\n\n    var db = MongoInternals.defaultRemoteCollectionDriver().mongo.db;\n    var getCollections = Meteor.wrapAsync(db.collections, db);\n    var collections = getCollections();\n\n    var appCollections = _.reject(collections, function (col) {\n      return col.collectionName.indexOf('velocity') === 0 || excludedCollections.indexOf(col.collectionName) !== -1;\n    });\n\n    _.each(appCollections, function (appCollection) {\n      var remove = Meteor.wrapAsync(appCollection.remove, appCollection);\n      remove({}, {});\n    });\n  };\n\n  Meteor.methods({\n    'xolvio:cleaner/resetDatabase': function (options) {\n      _resetDatabase(options);\n    }\n  });\n\n  resetDatabase = function (options, callback) {\n    _resetDatabase(options);\n\n    if (typeof callback === 'function') {\n      callback();\n    }\n  };\n}\n\nif (Meteor.isClient) {\n  resetDatabase = function (options, callback) {\n    Meteor.call('xolvio:cleaner/resetDatabase', options, callback);\n  };\n}\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}}}},{\n  \"extensions\": [\n    \".js\",\n    \".json\"\n  ]\n});\n\nrequire(\"/node_modules/meteor/xolvio:cleaner/cleaner.js\");\n\n/* Exports */\nPackage._define(\"xolvio:cleaner\", {\n  resetDatabase: resetDatabase\n});\n\n})();\n","servePath":"/packages/xolvio_cleaner.js","sourceMap":{"version":3,"sources":["packages/xolvio:cleaner/cleaner.js"],"names":["Meteor","isServer","_resetDatabase","options","process","env","NODE_ENV","Error","excludedCollections","concat","db","MongoInternals","defaultRemoteCollectionDriver","mongo","getCollections","wrapAsync","collections","appCollections","_","reject","col","collectionName","indexOf","each","appCollection","remove","methods","resetDatabase","callback","isClient","call"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAIA,MAAM,CAACC,QAAX,EAAqB;AACnB,MAAMC,cAAc,GAAG,UAAUC,OAAV,EAAmB;AACxC,QAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,aAA7B,EAA4C;AAC1C,YAAM,IAAIC,KAAJ,CACJ,iEACA,WAFI,CAAN;AAID;;AAEDJ,WAAO,GAAGA,OAAO,IAAI,EAArB;AACA,QAAIK,mBAAmB,GAAG,CAAC,gBAAD,CAA1B;;AACA,QAAIL,OAAO,CAACK,mBAAZ,EAAiC;AAC/BA,yBAAmB,GAAGA,mBAAmB,CAACC,MAApB,CAA2BN,OAAO,CAACK,mBAAnC,CAAtB;AACD;;AAED,QAAIE,EAAE,GAAGC,cAAc,CAACC,6BAAf,GAA+CC,KAA/C,CAAqDH,EAA9D;AACA,QAAII,cAAc,GAAGd,MAAM,CAACe,SAAP,CAAiBL,EAAE,CAACM,WAApB,EAAiCN,EAAjC,CAArB;AACA,QAAIM,WAAW,GAAGF,cAAc,EAAhC;;AACA,QAAIG,cAAc,GAAGC,CAAC,CAACC,MAAF,CAASH,WAAT,EAAsB,UAAUI,GAAV,EAAe;AACxD,aAAOA,GAAG,CAACC,cAAJ,CAAmBC,OAAnB,CAA2B,UAA3B,MAA2C,CAA3C,IACLd,mBAAmB,CAACc,OAApB,CAA4BF,GAAG,CAACC,cAAhC,MAAoD,CAAC,CADvD;AAED,KAHoB,CAArB;;AAKAH,KAAC,CAACK,IAAF,CAAON,cAAP,EAAuB,UAAUO,aAAV,EAAyB;AAC9C,UAAIC,MAAM,GAAGzB,MAAM,CAACe,SAAP,CAAiBS,aAAa,CAACC,MAA/B,EAAuCD,aAAvC,CAAb;AACAC,YAAM,CAAC,EAAD,EAAK,EAAL,CAAN;AACD,KAHD;AAID,GA1BD;;AA4BAzB,QAAM,CAAC0B,OAAP,CAAe;AACb,oCAAgC,UAAUvB,OAAV,EAAmB;AACjDD,oBAAc,CAACC,OAAD,CAAd;AACD;AAHY,GAAf;;AAMAwB,eAAa,GAAG,UAASxB,OAAT,EAAkByB,QAAlB,EAA4B;AAC1C1B,kBAAc,CAACC,OAAD,CAAd;;AACA,QAAI,OAAOyB,QAAP,KAAoB,UAAxB,EAAoC;AAAEA,cAAQ;AAAK;AACpD,GAHD;AAKD;;AACD,IAAI5B,MAAM,CAAC6B,QAAX,EAAqB;AACnBF,eAAa,GAAG,UAASxB,OAAT,EAAkByB,QAAlB,EAA4B;AAC1C5B,UAAM,CAAC8B,IAAP,CAAY,8BAAZ,EAA4C3B,OAA5C,EAAqDyB,QAArD;AACD,GAFD;AAGD,C","file":"/packages/xolvio_cleaner.js","sourcesContent":["if (Meteor.isServer) {\n  const _resetDatabase = function (options) {\n    if (process.env.NODE_ENV !== 'development') {\n      throw new Error(\n        'resetDatabase is not allowed outside of a development mode. ' +\n        'Aborting.'\n      );\n    }\n\n    options = options || {};\n    var excludedCollections = ['system.indexes'];\n    if (options.excludedCollections) {\n      excludedCollections = excludedCollections.concat(options.excludedCollections);\n    }\n\n    var db = MongoInternals.defaultRemoteCollectionDriver().mongo.db;\n    var getCollections = Meteor.wrapAsync(db.collections, db);\n    var collections = getCollections();\n    var appCollections = _.reject(collections, function (col) {\n      return col.collectionName.indexOf('velocity') === 0 ||\n        excludedCollections.indexOf(col.collectionName) !== -1;\n    });\n\n    _.each(appCollections, function (appCollection) {\n      var remove = Meteor.wrapAsync(appCollection.remove, appCollection);\n      remove({}, {});\n    });\n  };\n\n  Meteor.methods({\n    'xolvio:cleaner/resetDatabase': function (options) {\n      _resetDatabase(options);\n    }\n  });\n\n  resetDatabase = function(options, callback) {\n    _resetDatabase(options);\n    if (typeof callback === 'function') { callback(); }\n  }\n\n}\nif (Meteor.isClient) {\n  resetDatabase = function(options, callback) {\n    Meteor.call('xolvio:cleaner/resetDatabase', options, callback);\n  }\n}\n"]}}]