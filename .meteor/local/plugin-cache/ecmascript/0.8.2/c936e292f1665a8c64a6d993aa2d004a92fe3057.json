{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"meteor/ddp-rate-limiter","imported":["DDPRateLimiter"],"specifiers":[{"kind":"named","imported":"DDPRateLimiter","local":"DDPRateLimiter"}]},{"source":"meteor/underscore","imported":["_"],"specifiers":[{"kind":"named","imported":"_","local":"_"}]}],"exports":{"exported":["rateLimit","options"],"specifiers":[{"kind":"local","local":"rateLimit","exported":"default"},{"kind":"local","local":"options","exported":"default"}]}}},"options":{"filename":"imports/modules/rate-limit.js","filenameRelative":"imports/modules/rate-limit.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/modules/rate-limit.js.map","sourceFileName":"imports/modules/rate-limit.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"rate-limit"},"ignored":false,"code":"module.export({\n  \"default\": function () {\n    return rateLimit;\n  }\n});\nvar Meteor = void 0;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar DDPRateLimiter = void 0;\nmodule.watch(require(\"meteor/ddp-rate-limiter\"), {\n  DDPRateLimiter: function (v) {\n    DDPRateLimiter = v;\n  }\n}, 1);\n\nvar _ = void 0;\n\nmodule.watch(require(\"meteor/underscore\"), {\n  _: function (v) {\n    _ = v;\n  }\n}, 2);\n\nvar fetchMethodNames = function (methods) {\n  return _.pluck(methods, 'name');\n};\n\nvar assignLimits = function (_ref) {\n  var methods = _ref.methods,\n      limit = _ref.limit,\n      timeRange = _ref.timeRange;\n  var methodNames = fetchMethodNames(methods);\n\n  if (Meteor.isServer) {\n    DDPRateLimiter.addRule({\n      name: function (name) {\n        return _.contains(methodNames, name);\n      },\n      connectionId: function () {\n        return true;\n      }\n    }, limit, timeRange);\n  }\n};\n\nfunction rateLimit(options) {\n  return assignLimits(options);\n}","map":{"version":3,"sources":["imports/modules/rate-limit.js"],"names":["module","export","rateLimit","Meteor","watch","require","v","DDPRateLimiter","_","fetchMethodNames","pluck","methods","assignLimits","limit","timeRange","methodNames","isServer","addRule","name","contains","connectionId","options"],"mappings":"AAAAA,OAAOC,MAAP,CAAc;AAAC,aAAQ;AAAA,WAAIC,SAAJ;AAAA;AAAT,CAAd;AAAuC,IAAIC,eAAJ;AAAWH,OAAOI,KAAP,CAAaC,QAAQ,eAAR,CAAb,EAAsC;AAACF,QAAD,YAAQG,CAAR,EAAU;AAACH,aAAOG,CAAP;AAAS;AAApB,CAAtC,EAA4D,CAA5D;AAA+D,IAAIC,uBAAJ;AAAmBP,OAAOI,KAAP,CAAaC,QAAQ,yBAAR,CAAb,EAAgD;AAACE,gBAAD,YAAgBD,CAAhB,EAAkB;AAACC,qBAAeD,CAAf;AAAiB;AAApC,CAAhD,EAAsF,CAAtF;;AAAyF,IAAIE,UAAJ;;AAAMR,OAAOI,KAAP,CAAaC,QAAQ,mBAAR,CAAb,EAA0C;AAACG,GAAD,YAAGF,CAAH,EAAK;AAACE,QAAEF,CAAF;AAAI;AAAV,CAA1C,EAAsD,CAAtD;;AAInO,IAAMG,mBAAmB;AAAA,SAAWD,EAAEE,KAAF,CAAQC,OAAR,EAAiB,MAAjB,CAAX;AAAA,CAAzB;;AAEA,IAAMC,eAAe,gBAAmC;AAAA,MAAhCD,OAAgC,QAAhCA,OAAgC;AAAA,MAAvBE,KAAuB,QAAvBA,KAAuB;AAAA,MAAhBC,SAAgB,QAAhBA,SAAgB;AACtD,MAAMC,cAAcN,iBAAiBE,OAAjB,CAApB;;AAEA,MAAIR,OAAOa,QAAX,EAAqB;AACnBT,mBAAeU,OAAf,CAAuB;AACrBC,UADqB,YAChBA,IADgB,EACV;AAAE,eAAOV,EAAEW,QAAF,CAAWJ,WAAX,EAAwBG,IAAxB,CAAP;AAAuC,OAD/B;AAErBE,kBAFqB,cAEN;AAAE,eAAO,IAAP;AAAc;AAFV,KAAvB,EAGGP,KAHH,EAGUC,SAHV;AAID;AACF,CATD;;AAWe,SAASZ,SAAT,CAAmBmB,OAAnB,EAA4B;AAAE,SAAOT,aAAaS,OAAb,CAAP;AAA+B","file":"imports/modules/rate-limit.js.map","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { DDPRateLimiter } from 'meteor/ddp-rate-limiter';\nimport { _ } from 'meteor/underscore';\n\nconst fetchMethodNames = methods => _.pluck(methods, 'name');\n\nconst assignLimits = ({ methods, limit, timeRange }) => {\n  const methodNames = fetchMethodNames(methods);\n\n  if (Meteor.isServer) {\n    DDPRateLimiter.addRule({\n      name(name) { return _.contains(methodNames, name); },\n      connectionId() { return true; },\n    }, limit, timeRange);\n  }\n};\n\nexport default function rateLimit(options) { return assignLimits(options); }\n"]},"hash":"c936e292f1665a8c64a6d993aa2d004a92fe3057"}
